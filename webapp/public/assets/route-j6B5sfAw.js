import{j as r}from"./jsx-runtime-56DGgGmo.js";import{a as g}from"./api-components-dDIZztSJ.js";import{B as h}from"./button-CS9qg6Tt.js";import{D as j}from"./date-input-Br46mw6i.js";import{F as p,T as c}from"./form-frame-AzQ8YT1a.js";import{T as l}from"./text-DfCqYLRl.js";import{s as v}from"./storage-Coaj7Roq.js";import{k as b,F as N,l as _}from"./components-Cbm4tYXz.js";import{j as x,r as S}from"./responses-Cu7_GOWP.js";import"./bundle-mjs-Dnoi3Axr.js";import"./index-9ZhTBp7q.js";const E=()=>[{title:"Regiter | ISURIDE"},{name:"description",content:"ユーザー登録"}],B=async({request:e})=>{const t=await e.formData(),s={},o=String(t.get("date_of_birth")),n=String(t.get("username")),a=String(t.get("firstname")),m=String(t.get("lastname")),d=String(t.get("invitation_code"));if(n.length>30&&(s.username="30文字以内で入力してください"),a.length>30&&(s.firstname="30文字以内で入力してください"),m.length>30&&(s.lastname="30文字以内で入力してください"),Object.keys(s).length>0)return x({errors:s});try{const i=await g({body:{date_of_birth:o,username:n,firstname:a,lastname:m,invitation_code:d}});return v({invitationCode:i.invitation_code,registedAt:new Date().toISOString(),used:!1}),S("/client/register-payment")}catch(i){return console.error(`ERROR: ${JSON.stringify(i)}`),s.register="ユーザーの登録に失敗しました。接続に問題があるか、ユーザー名が登録済みの可能性があります。",x({errors:s})}};function P(){var t,s,o,n,a,m,d,i,f,u;const e=b();return r.jsxs(p,{children:[r.jsx("h1",{className:"text-2xl font-semibold mb-6",children:"ユーザー登録"}),((t=e==null?void 0:e.errors)==null?void 0:t.register)&&r.jsx(l,{variant:"danger",size:"sm",className:"mb-6",children:(s=e==null?void 0:e.errors)==null?void 0:s.register}),r.jsxs(N,{className:"flex flex-col gap-4",method:"POST",children:[r.jsxs("div",{children:[r.jsx(c,{id:"username",name:"username",label:"ユーザー名",required:!0}),((o=e==null?void 0:e.errors)==null?void 0:o.username)&&r.jsx(l,{variant:"danger",className:"mt-2",children:(n=e==null?void 0:e.errors)==null?void 0:n.username})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"w-full",children:[r.jsx(c,{id:"lastname",name:"lastname",label:"姓",required:!0}),((a=e==null?void 0:e.errors)==null?void 0:a.lastname)&&r.jsx(l,{variant:"danger",className:"mt-2",children:(m=e==null?void 0:e.errors)==null?void 0:m.lastname})]}),r.jsxs("div",{className:"w-full",children:[r.jsx(c,{id:"firstname",name:"firstname",label:"名",required:!0}),((d=e==null?void 0:e.errors)==null?void 0:d.firstname)&&r.jsx(l,{variant:"danger",className:"mt-2",children:(i=e==null?void 0:e.errors)==null?void 0:i.firstname})]})]}),r.jsx("div",{children:r.jsx(j,{id:"date_of_birth",name:"date_of_birth",label:"誕生日",defaultValue:"2000-04-01",required:!0})}),r.jsxs("div",{className:"mb-6",children:[r.jsx(c,{id:"invitation_code",name:"invitation_code",label:"招待コード (お持ちの方のみ入力)"}),((f=e==null?void 0:e.errors)==null?void 0:f.invitation_code)&&r.jsx(l,{variant:"danger",className:"mt-2",children:(u=e==null?void 0:e.errors)==null?void 0:u.invitation_code})]}),r.jsx(h,{type:"submit",variant:"primary",className:"text-lg",children:"登録"}),r.jsx("p",{className:"text-center mt-2",children:r.jsx(_,{to:"/client/login",className:"text-blue-600 hover:underline",children:"ログイン"})})]})]})}export{B as clientAction,P as default,E as meta};

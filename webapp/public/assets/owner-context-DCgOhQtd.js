import{r as t,j as h}from"./jsx-runtime-56DGgGmo.js";import{n as p,o as x}from"./api-components-dDIZztSJ.js";import{g as C}from"./get-cookie-value-B3QhECDc.js";import{f as y}from"./index-9ZhTBp7q.js";const l=t.createContext({}),u=s=>Math.floor(new Date(s).getTime()),O=(()=>{const s=new Date().getTimezoneOffset()*6e4;return new Date(Date.now()-s).toISOString().slice(0,10)})(),f=s=>/\d{4}-\d{2}-\d{2}/.test(s),j=({children:s})=>{const[a,i]=t.useState(),[d,c]=t.useState(),o=y(),[r,m]=t.useState("2024-11-01"),[n,w]=t.useState(O),g=t.useCallback(e=>{f(e)&&m(e)},[]),S=t.useCallback(e=>{f(e)&&w(e)},[]);return t.useEffect(()=>{(async()=>{try{const e=await p({});i(e.chairs)}catch(e){console.error(e)}})()},[]),t.useEffect(()=>{(async()=>{try{const e=await x({queryParams:{since:u(r),until:u(n)}});c(e)}catch(e){console.error(e)}})()},[o,i,c,r,n]),t.useEffect(()=>{typeof C(document.cookie,"owner_session")<"u"||o("/owner/register")},[o]),h.jsx(l.Provider,{value:{chairs:a,sales:d,until:n,since:r,setUntil:S,setSince:g},children:s})},P=()=>t.useContext(l);export{j as O,P as u};
